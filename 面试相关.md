# 面试相关

Android面试简单总结

## 性能优化问题

### UI优化

- 合理选择RelativeLayout、LinearLayout、FrameLayout,RelativeLayout会让子View调用2次onMeasure，而且布局相对复杂时，onMeasure相对比较复杂，效率比较低，LinearLayout在weight>0时也会让子View调用2次onMeasure。LinearLayout weight测量分配原则。
- 使用标签  include  merge ViewStub
- 减少布局层级，可以通过手机开发者选项>GPU过渡绘制查看，一般层级控制在4层以内，超过5层时需要考虑是否重新排版布局。
- 自定义View时，重写onDraw()方法，不要在该方法中新建对象，否则容易触发GC，导致性能下降
- 使用ListView时需要复用contentView，并使用Holder减少findViewById加载View。
- 去除不必要背景，getWindow().setBackgroundDrawable(null)
- 使用TextView的leftDrawabel/rightDrawable代替ImageView+TextView布局

### 内存优化(主要为了避免OOM和频繁触发到GC导致性能下降)

- Bitmap.recycle(),Cursor.close,inputStream.close()
- 大量加载Bitmap时，根据View大小加载Bitmap，合理选择inSampleSize，RGB_565编码方式；使用LruCache缓存
- 使用 静态内部类+WeakReference 代替内部类，如Handler、线程、AsyncTask
- 使用线程池管理线程，避免线程的新建
- 使用单例持有Context，需要记得释放，或者使用全局上下文
- 静态集合对象注意释放
- 属性动画造成内存泄露
- 使用webView，在Activity.onDestory需要移除和销毁，webView.removeAllViews()和webView.destory()
- 备：使用LeakCanary检测内存泄露